<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="ngPatient.csp" application="/csp/setanalysis/" default="1"><![CDATA[
<!DOCTYPE html>
<html ng-app="PatientApp">
  <head>
<!-- <link rel="stylesheet" type="text/css" href="nglib/bootstrap/css/bootstrapSpacelab.min.css" /> -->
 <link rel="stylesheet" type="text/css" href="nglib/bootstrap/css/bootstrap.min.css" />
 <link rel="stylesheet" type="text/css" href="nglib/additional.css" />
 <link rel="stylesheet" type="text/css" href="ngTreeView.css" /> 

     <style>
	.negation {
		color: red;
	}
	.term {
		background-color: green;
		color: white;
		font-weight:bold;
	}
	.selection {
		background-color: LightBlue;
	}
	.sentence {
		font-weight:bold;
	}
	.HeightFull {
		max-height: 450px;
		overflow-y: scroll;
	}
	.HeightMax {
		max-height: 605px;
		overflow-y: scroll;
	}
    </style>   
<style type="text/css">
    /* show the move cursor as the user moves the mouse over the panel header.*/
    #draggablePanelList .panel-heading {
        cursor: move;
    }
</style>
 </head>
 <body>
   <div ng-controller="PatientController as patient" >
     <div class="panel panel-default">
       <div class="panel-heading">Patient Id {{PatientData.PatientId}}
       	 <span class="pull-right">
            <div ng-click="toggleExpandPatientDetail()"><a class="icon-link"><span ng-class="{'glyphicon glyphicon-chevron-up':showPatientDetail(),'glyphicon glyphicon-chevron-down':!showPatientDetail()}"></span> </a>
            </div>
		 </span>
       </div>
       <div class="panel-body" ng-show="showPatientDetail()">
	     <label>{{PatientData.Name}}</label><br>
	     <label>{{PatientData.Street}}</label><br>
	     <label>{{PatientData.City}}</label></br>
         <label>Gender : {{PatientData.Gender}}</label><br>
         <label>{{PatientData.Documents}} document(s)</label><br>
         <label ng-repeat="tag in PatientData.Tags">{{tag.Category}}:{{tag.Tag}}, </label>
       </div>
     </div>

  
     <ul class="nav nav-tabs" >
       <li class="active"><a href="ngPatient.csp#concepts" data-toggle="tab" aria-expanded="false">Concepts</a></li>
       <li class=""><a href="ngPatient.csp#sets" data-toggle="tab" aria-expanded="true">Sets</a></li>
       <li class=""><a href="ngPatient.csp#sources" data-toggle="tab" aria-expanded="true">Sources</a></li>
       <li class=""><a href="ngPatient.csp#tags" data-toggle="tab" aria-expanded="true">Tags</a></li>
     </ul>

     <div id="myTabContent" class="tab-content">

       <div class="tab-pane fade  active in" id="concepts">
         <br><div class="row">
           <div class="col-md-4">
	         <label>
	            Find concept: <input type="text" ng-model="FindConcept" ng-change="RefreshSimilarConcepts()"></input>
	         </label>
           </div>  <!--col-->
           <div class="col-md-6">
	            <div >
	              <span ng-repeat="dictionary in dictionaries">
	                <label>
	                 <input type="checkbox" ng-model="dictionary.Checked" ng-change="RefreshConcepts()"> {{dictionary.Name}}</input>&nbsp;
	               </label>
	              </span>
	            </div>
	       </div>
<!--	       <div class="col-md-1">
	            <span >
	               <input id="slider" type="range" min="0" max="100" step="10" ng-model="matchScore" ng-change="RefreshConcepts()"/>
	            </span>
           </div>
-->	       <div class="col-md-2">
              Match score: <input type="text" ng-model="matchScore" size="2"></input>%&nbsp;<i class="glyphicon glyphicon-refresh" ng-click="RefreshConcepts()" ></i>
           </div>
         </div>
	   	 <div class="row">
		   <div class="col-md-4">
	         <div class="panel panel-primary">
	           <div class="panel-heading">Concepts</div>
	           <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
                 <table class="table table-hover">
			       <thead>
			         <th ng-click="sortC('Entity')">Entity
			           <i ng-class="{'glyphicon glyphicon-chevron-up': isSortUpC('Entity'), 'glyphicon glyphicon-chevron-down': isSortDownC('Entity')}"></i>
			         </th>
			         <th ng-click="sortC('Frequency')">Freq<i ng-class="{'glyphicon glyphicon-chevron-up': isSortUpC('Frequency'), 'glyphicon glyphicon-chevron-down': isSortDownC('Frequency')}"></i>
			         </th>
			         <th ng-click="sortC('Score')">Score<i ng-class="{'glyphicon glyphicon-chevron-up': isSortUpC('Score'), 'glyphicon glyphicon-chevron-down': isSortDownC('Score')}"></i>
			         </th>
			         <th></th>
			         <th></th>
			         <th></th>
			       </thead>
                   <tr ng-repeat="concept in filteredConcepts = (Concepts | orderBy:sortFieldC:reverseC)" ng-class="{'info':inSelection(concept.Selection),'danger':isConceptNegated(concept.Negated),'warning':isSomeConceptNegated(concept.Negated)}"> <!--ng-class="{'success': isDictionary(), 'danger' : !isDictionary()}">  -->
	                  <td ng-click="getSimRel(concept,$index)">{{concept.Entity}}</td>
	                  <td>{{concept.Frequency}}</td>
	                  <td>{{concept.Score}}</td>
			          <td ng-if='!isDictionary()' ng-click="toDictionary(concept.Entity,$index)"><span class="glyphicon glyphicon-thumbs-up"></span></td>
			          <td ng-if='isDictionary()' ng-click="fromDictionary(concept.Entity,$index)"><span class="glyphicon glyphicon-thumbs-down"></span></td>
			          <td ng-if='!isDictionary()' ng-click="toBlacklist(concept.Entity,$index)"><span class="glyphicon glyphicon-thumbs-down"></span></td>
			          <td ng-click="toTags(concept.Entity,$index)"><span class="glyphicon glyphicon-tag"></span></td>
	                </tr>
	             </table>
 		       </div>
	 		 </div>
           </div> <!--col-md-4-->
           <div class="col-md-4" ng-show="showSourcesNormal()">
		     <div class="row">
		       <div class="col-md-12">
	             <div class="panel panel-primary">
	               <div class="panel-heading">Similar</div>
	               <div class="panel-body" style="max-height: 200px;overflow-y: scroll;">
                     <table class="table table-hover">
                       <tr ng-repeat="similar in Similar">  
	                     <td ng-click="getRel(similar, $index)" ng-class="{'danger':isConceptNegated(concept.Negated),'warning':isSomeConceptNegated(concept.Negated)}">{{similar.Entity}}</td>
	                     <td>{{similar.Frequency}}</td>
			             <td ng-click="toTags(similar.Entity,$index)"><span class="glyphicon glyphicon-tag"></span></td>
	                   </tr>
	                 </table>
 		           </div>
	 		     </div>
               </div> <!--col-md-12-->
             </div> <!--row-->
		     <div class="row">
		       <div class="col-md-12">
	             <div class="panel panel-primary">
	               <div class="panel-heading">Related</div>
	               <div class="panel-body" style="max-height: 200px;overflow-y: scroll;">
                     <table class="table table-hover">
                       <tr ng-repeat="related in Related">  
	                     <td>{{related.Entity}}</td>
	                     <td>{{related.Frequency}}</td>
			             <td ng-click="toTags(related.Entity,$index)"><span class="glyphicon glyphicon-tag"></span></td>
	                   </tr>
	                 </table>
 		           </div>
	 		     </div>
               </div> <!--col-md-12 -->
             </div> <!-- row -->
		     <div class="row" ng-show="checkedDictionary()">
		       <div class="col-md-12">
	             <div class="panel panel-primary">
	               <div class="panel-heading">Dictionary Match Scores</div>
	               <div class="panel-body" style="max-height: 200px;overflow-y: scroll;">
                     <table class="table table-hover">
                       <tr ng-repeat="match in Matches">  
	                     <td>{{match.Dictionary}} {{match.Snomed}}</td>
	                     <td>{{match.Term}}</td>
	                     <td>{{match.Score}}</td>
			             <td ng-click="toTagsSnomed(match.Term,$index,match.Snomed)"><span class="glyphicon glyphicon-tag"></span></td>
	                   </tr>
	                 </table>
 		           </div>
	 		     </div>
               </div> <!--col-md-12 -->
             </div> <!-- row -->
          </div> <!-- col-md-4 -->
          <div ng-class="{'col-md-4': showSourcesNormal(), 'col-md-8' : !showSourcesNormal()}">
          <!-- <div class="col-md-4"> -->
	         <div class="panel panel-primary">
	           <div class="panel-heading">Source
	           	 <span class="pull-right">
	               <div ng-click="toggleExpandSources()"><a class="icon-link"><span ng-class="{'glyphicon glyphicon-chevron-left':showSourcesNormal(),'glyphicon glyphicon-chevron-right':!showSourcesNormal()}"></span> </a>
	               </div>
				 </span>
	           </div>
	           <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
                 <table class="table table-hover">
                    <tr ng-repeat="source in Sources" ng-controller="SafeHtmlController">  
	                  <td>
	                    <div ng-bind-html="SafeHtml"></div>
	                  </td>
	                </tr>
	             </table>
 		       </div>
	 		 </div>
           </div> <!--col-md-3-->

         </div>
       </div>

	   <div class="tab-pane fade" id="sets">
	   	   <div class="row">
		     <div class="col-md-6">
		       <div
		        data-angular-treeview="true"
		        data-tree-model="roleList"
		        data-node-id="roleId"
		        data-node-label="roleName"
		        data-node-children="children" >
		       </div>
		     </div>
		     <div class="col-md-6">
		      <!--- <div class="row"><div ng-bind-html="HighlightSentence"></div> </div>  --->
		       <div class="row" ng-show="PanelVisible">
	             <div class="panel panel-primary">
	               <div class="panel-heading">Source</div>
	           	   <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
	                 <div ng-bind-html="HighlightSource"></div>
	 		       </div>
	 		     </div>
		       </div>
		     </div> <!--col -->
	       </div> <!--row-->
	   </div> <!--tabpane sets-->

	   <div class="tab-pane fade" id="sources">
	   	   <div class="row">

		     <div class="col-md-3">
	           <div class="panel panel-primary">
	             <div class="panel-heading">Sources
	             </div>
	             <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
                   <table class="table table-hover">
                      <tr ng-repeat="source in AllSources">  
	                    <td ng-click="showSource(source.SourceId)">{{source.FileName}}</td>
	                    <td>{{source.Speciality}}</td>
	                    <td>{{source.Category}}</td>
	                  </tr>
	               </table>
 		         </div>
	 		   </div>
		     </div> <!--col -->
		     <div class="col-md-9">
	           <div class="panel panel-primary">
	             <div class="panel-heading">Source
	             </div>
	           <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
	                 <div ng-bind-html="HighlightSource"></div>
	             </div>
	 		   </div>
		     </div> <!--col -->

	       </div> <!--row-->
	   </div> <!--tabpane sources-->

	   <div class="tab-pane fade" id="tags">
	   	   <div class="row">
		   <div class="col-md-4">
	         <div class="panel panel-primary">
	           <div class="panel-heading">Tags</div>
	           <div ng-class="{'panel-body HeightFull':showPatientDetail(),'panel-body HeightMax':!showPatientDetail()}">
                 <table class="table table-hover">
                   <tr ng-repeat="tag in tags" >
	                  <td>{{tag.Tag}}</td>
			          <td ng-click="deleteTag(tag.Tag,$index)"><span class="glyphicon glyphicon-remove"></span></td>
	                </tr>
	             </table>
 		       </div>
	 		 </div>
           </div> <!--col-md-4-->
	       </div> <!--row-->

	   </div> <!--tabpane tags-->

      </div> <!--myTabContent-->

    <script type="text/ng-template" id="modalSaveTag.html">
       <div class="modal-header">
       <h3 class="modal-title">Save tag to Electronic Patient Record</h3>
       </div> 
       <div class="modal-body">
         <div class="form-group">
           <label for="inputTag" class="control-label col-xs-2">Tag</label>
           <input id="inputTag" type="text" ng-model="tag.Value"/>
         </div>
         
         <div class="form-group">
           <label for="inputCat" class="control-label col-xs-2">Category</label>
           <select id="inputCat" ng-model="tag.Category" ng-options="cat for cat in tag.Categories" /></select>
         </div>

         <div class="form-group">
           <label for="inputSnomed" class="control-label col-xs-2">Snomed</label>
           <input id="inputSnomed" type="text" ng-model="tag.Snomed" />
         </div>

       </div>

       <div class="modal-footer">
       <button type="button" class="btn btn-primary" ng-click="save();"><span class=" glyphicon glyphicon-floppy-disk"></span> Save</button>
       <button type="button" class="btn btn-warning" ng-click="cancel();"><span class="glyphicon glyphicon-remove"></span> Cancel</button>
       </div>
    </script>  

    </div> <!--controller-->


  </body>
</html>
]]></CSP>
</Export>
